<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" type="image/png" href="pecos.png"/>
<title>Business Dashboard | Pecos</title>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

<style>
*{box-sizing:border-box}
html,body{margin:0;font-family:'Montserrat',sans-serif;background:#f4f6f9;color:#222}
body{display:none}

header{
  background:#003366;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 20px
}
.brand{display:flex;align-items:center;gap:12px}
.brand img{height:36px}
.brand .title{font-weight:700;font-size:18px}

.page{max-width:1200px;margin:20px auto;padding:0 16px}
.layout{display:grid;grid-template-columns:260px 1fr;gap:20px}

.sidebar{
  background:#003366;
  color:#fff;
  padding:20px;
  border-radius:10px
}
.sidebar h3{
  margin:0 0 12px;
  border-bottom:1px solid rgba(255,255,255,0.08);
  padding-bottom:8px
}
.sidebar ul{list-style:none;padding:0;margin:0}
.sidebar li{margin-bottom:10px}
.sidebar a{
  display:block;
  color:#fff;
  text-decoration:none;
  padding:8px 10px;
  border-radius:8px
}
.sidebar a:hover{background:rgba(255,255,255,0.06)}

.main{
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,0.06)
}

.hero{
  background:#fffdfc;
  padding:16px;
  border-radius:8px;
  border:1px solid #eef2f6;
  margin-bottom:20px
}
.hero h2{margin:0;color:#003366}
.hero p{margin-top:6px;color:#555}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:16px
}

.card{
  background:#fff;
  padding:16px;
  border-radius:10px;
  border:1px solid #eef2f6;
  box-shadow:0 2px 6px rgba(0,0,0,0.04)
}
.card h4{margin:0 0 6px;color:#003366}
.card input{
  width:100%;
  padding:10px;
  border:1px solid #d8e1ea;
  border-radius:8px;
  font-size:14px;
  margin-top:8px
}

.summary{
  font-size:26px;
  font-weight:700;
  color:#003366;
  margin-top:10px
}

.btn{
  background:#003366;
  color:#fff;
  border:none;
  padding:12px 18px;
  border-radius:8px;
  font-weight:700;
  cursor:pointer
}
.btn:hover{background:#002a53}

footer{
  margin-top:18px;
  text-align:center;
  font-size:13px;
  color:#666
}

@media(max-width:800px){
  .layout{display:flex;flex-direction:column}
}
</style>
</head>

<body>

<header>
  <div class="brand">
    <img src="pecos.png">
    <div>
      <div class="title">Pecos</div>
      <div style="font-size:12px;color:#fff9a8">Business Dashboard</div>
    </div>
  </div>
</header>

<div class="page">
<div class="layout">

<aside class="sidebar">
  <h3>Admin Menu</h3>
  <ul>
    <li><a href="member.html">← Member Dashboard</a></li>
    <li><a>Business Overview</a></li>
  </ul>
</aside>

<main class="main">

  <div class="hero">
    <h2>Business Revenue Overview</h2>
    <p>Confidential financial summary — admin access only.</p>
    <div class="summary" id="totalIncome">₹ 0</div>
  </div>

  <div class="grid">
    <div class="card">
      <h4>Interest Income</h4>
      <input type="number" id="interestIncome">
    </div>

    <div class="card">
      <h4>Dividend Income</h4>
      <input type="number" id="dividendIncome">
    </div>

    <div class="card">
      <h4>Rental Income</h4>
      <input type="number" id="rentalIncome">
    </div>

    <div class="card">
      <h4>Trading Income</h4>
      <input type="number" id="tradingIncome">
    </div>

    <div class="card">
      <h4>Other Income</h4>
      <input type="number" id="otherIncome">
    </div>
  </div>

  <div style="margin-top:20px">
    <button class="btn" onclick="saveIncome()">Save Changes</button>
  </div>

</main>
</div>

<footer>© 2025 Pecos | Confidential Business Data</footer>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDnbqKwqvg9BoAjpgMBFCr3ZBOFOcuvZxs",
  authDomain: "pecos-432b5.firebaseapp.com",
  projectId: "pecos-432b5",
  storageBucket: "pecos-432b5.appspot.com"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(async user=>{
  if(!user) return location.href="index.html";

  const snap = await db.collection("members").doc(user.uid).get();
  if(!snap.exists || snap.data().role!=="admin"){
    alert("Admins only");
    return location.href="member.html";
  }

  document.body.style.display="block";
  loadIncome();
});

async function loadIncome(){
  const snap = await db.collection("businessIncome").doc("summary").get();
  if(!snap.exists) return;

  const d = snap.data();
  interestIncome.value = d.interestIncome||0;
  dividendIncome.value = d.dividenedIncome||0;
  rentalIncome.value = d.rentalIncome||0;
  tradingIncome.value = d.tradingIncome||0;
  otherIncome.value = d.otherIncome||0;

  updateTotal();
}

function updateTotal(){
  const total =
    (+interestIncome.value||0) +
    (+dividendIncome.value||0) +
    (+rentalIncome.value||0) +
    (+tradingIncome.value||0) +
    (+otherIncome.value||0);

  totalIncome.innerText = "₹ " + total;
}

document.querySelectorAll("input").forEach(i=>{
  i.addEventListener("input",updateTotal);
});

async function saveIncome(){
  await db.collection("businessIncome").doc("summary").set({
    interestIncome:+interestIncome.value,
    dividenedIncome:+dividendIncome.value,
    rentalIncome:+rentalIncome.value,
    tradingIncome:+tradingIncome.value,
    otherIncome:+otherIncome.value,
    updatedAt:new Date()
  });
  alert("Business income updated successfully");
}
</script>

</body>
</html>
