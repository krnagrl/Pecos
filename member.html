<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="pecos.png"/>
  <title>Member Dashboard | Pecos</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

  <style>
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Montserrat',sans-serif;background:#f4f6f9;color:#222}
    body{display:none;}

    header{background:#003366;color:#fff;display:flex;align-items:center;justify-content:space-between;padding:14px 20px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{height:36px}
    .brand .title{font-weight:700;font-size:18px}
    nav.header-actions{display:flex;align-items:center;gap:12px}
    #welcome-message{font-weight:600}
    #nav-logout{cursor:pointer;font-weight:700;color:#fff;text-decoration:none}

    .page{max-width:1200px;margin:20px auto;padding:0 16px}
    .layout{display:grid;grid-template-columns:260px 1fr;gap:20px}

    .sidebar{background:#003366;color:#fff;padding:20px;border-radius:10px}
    .sidebar h3{margin:0 0 12px 0;border-bottom:1px solid rgba(255,255,255,0.06);padding-bottom:8px}
    .sidebar ul{list-style:none;margin:12px 0 0 0;padding:0}
    .sidebar li{margin-bottom:10px}
    .sidebar a{display:block;color:#fff;text-decoration:none;padding:8px 10px;border-radius:8px;}
    .sidebar a:hover{background:rgba(255,255,255,0.04)}

    .main{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.06)}
    .hero{background:#fffdfc;padding:16px;border-radius:8px;margin-bottom:16px;border:1px solid #eef2f6}
    .hero h2{margin:0 0 8px 0;color:#003366}

    .grid-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .card{background:#fff;padding:16px;border-radius:10px;border:1px solid #eef2f6;box-shadow:0 2px 6px rgba(0,0,0,0.04)}
    .card h4{margin:0 0 8px 0;color:#003366}

    input,select{width:100%;padding:12px;border:1px solid #d8e1ea;border-radius:8px;font-size:14px;margin-bottom:12px}
    .btn{background:#003366;color:#fff;border:none;padding:10px 16px;border-radius:8px;font-weight:700;cursor:pointer}
    .btn:hover{background:#002a53}

    footer{margin-top:18px;text-align:center;color:#666;font-size:13px}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="pecos.png" alt="Pecos" />
      <div>
        <div class="title">Pecos</div>
        <div style="font-size:12px;color:#fff9a8">Member Dashboard</div>
      </div>
    </div>
    <nav class="header-actions">
      <div id="welcome-message">Checking login...</div>
      <a id="nav-logout">Logout</a>
    </nav>
  </header>

  <div class="page">
    <div class="layout">
      <aside class="sidebar">
        <h3>Dashboard Menu</h3>
        <ul>
          <li><a onclick="showSection('overview')">Overview</a></li>
          <li><a onclick="showSection('profile')">Profile</a></li>
          <li><a onclick="showSection('finance')">Finance</a></li>
          <li id="businessMenu" style="display:none;"><a href="business.html">Business</a></li>
        </ul>
      </aside>

      <main class="main">
        <section id="overview" class="section">
          <h2>Welcome to Pecos</h2>
          <div id="financeRequestsList">Loading...</div>
        </section>

        <section id="profile" class="section" style="display:none">
          <p><strong>Name:</strong> <span id="profile-name"></span></p>
          <p><strong>Email:</strong> <span id="profile-email"></span></p>
          <p><strong>Phone:</strong> <span id="profile-phone"></span></p>
        </section>

        <section id="finance" class="section" style="display:none">
          <form id="financeForm">
            <input id="name" placeholder="Name" required>
            <input id="amount" type="number" placeholder="Amount" required>
            <input id="bankName" placeholder="Bank Name" required>
            <input id="accountNumber" placeholder="Account Number" required>
            <input id="ifscCode" placeholder="IFSC Code" required>
            <select id="loanType" required>
              <option value="">Select Type</option>
              <option>Personal</option>
              <option>Commercial</option>
            </select>
            <button class="btn">Submit</button>
          </form>
          <p id="financeMsg"></p>
        </section>
      </main>
    </div>
    <footer>© 2025 Pecos</footer>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDnbqKwqvg9BoAjpgMBFCr3ZBOFOcuvZxs",
      authDomain: "pecos-432b5.firebaseapp.com",
      projectId: "pecos-432b5",
      storageBucket: "pecos-432b5.appspot.com"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    auth.onAuthStateChanged(async user => {
      if (!user) location.href='index.html';
      document.body.style.display='block';
      document.getElementById('welcome-message').innerText=`Welcome, ${user.email}`;
      loadFinanceRequests(user);
    });

    function showSection(id){
      document.querySelectorAll('.section').forEach(s=>s.style.display='none');
      document.getElementById(id).style.display='block';
    }

    async function loadFinanceRequests(user){
      const snap=await db.collection('financeRequests').where('userId','==',user.uid).get();
      let html='<table>';
      snap.forEach(d=>html+=`<tr><td>₹${d.data().amount}</td><td>${d.data().status}</td></tr>`);
      html+='</table>';
      document.getElementById('financeRequestsList').innerHTML=html;
    }
  </script>
</body>
</html>
